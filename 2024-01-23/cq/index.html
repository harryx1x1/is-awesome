
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../cq-en/">
      
      
        <link rel="next" href="../../2024-05-16/jolt-notes/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.36">
    
    
      
        <title>简析 Cached Quotients Lookup Arguments - Harry's Notes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.06209087.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/font.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cached-quotients-lookup-arguments" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Harry&#39;s Notes" class="md-header__button md-logo" aria-label="Harry's Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Harry's Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              简析 Cached Quotients Lookup Arguments
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Harry&#39;s Notes" class="md-nav__button md-logo" aria-label="Harry's Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Harry's Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2023 12 05
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            2023 12 05
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023-12-05/thoughts-about-community/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    如何做好社区？在伊斯坦布尔 Devconnect 期间的思考
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2023 12 06
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            2023 12 06
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023-12-06/publish-obsidian-notes-to-website/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    如何发布一个 Obsidian 的笔记网站
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2023 12 07
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            2023 12 07
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023-12-07/zkp-space-lookups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Twitter space: Lookups
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2023 12 09
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            2023 12 09
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023-12-09/lookup-arguments-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lookup Arguments Overview
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2023 12 25
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            2023 12 25
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023-12-25/ec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    椭圆曲线(Elliptic Curve)的神奇性质
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 01 06
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            2024 01 06
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-01-06/joy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    我的人生哲学: 快乐理论
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 01 23
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            2024 01 23
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cq-en/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    An Introduction to Cached Quotients Lookup Arguments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    简析 Cached Quotients Lookup Arguments
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    简析 Cached Quotients Lookup Arguments
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lookup" class="md-nav__link">
    <span class="md-ellipsis">
      Lookup 要解决的问题
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cq" class="md-nav__link">
    <span class="md-ellipsis">
      CQ 的贡献
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      对数导数
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lookup_1" class="md-nav__link">
    <span class="md-ellipsis">
      对数导数 lookup 协议
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pairing-a_i-b_i" class="md-nav__link">
    <span class="md-ellipsis">
      多项式构造和 pairing: 证明 \(a_i\) 和 \(b_i\)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumcheck" class="md-nav__link">
    <span class="md-ellipsis">
      Sumcheck
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      致谢
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      参考
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 05 16
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            2024 05 16
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-05-16/jolt-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notes about Jolt
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 05 28
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            2024 05 28
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-05-28/bit-commitment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How bit commitment works
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 05 29
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            2024 05 29
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-05-29/bitvm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BitVM 介绍
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 05 30
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            2024 05 30
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-05-30/why-no-zk-in-bitcoin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Why There’s No ZK in Bitcoin: The Missing Pieces
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 06 01
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            2024 06 01
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-06-01/bitvm-script/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BitVM Script
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 06 23
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            2024 06 23
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-06-23/commutative-algebra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    交换代数学习笔记
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 09 03
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            2024 09 03
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-09-03/Drawing-root-of-unity-complex-n4.excalidraw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drawing root of unity complex n4.excalidraw
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-09-03/Drawing-root-of-unity-complex-n8.excalidraw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drawing root of unity complex n8.excalidraw
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-09-03/Drawing-root-of-unity-group-n16.excalidraw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drawing root of unity group n16.excalidraw
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-09-03/roots-of-unity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roots of Unity: An Introduction
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 09 11
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            2024 09 11
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-09-11/field-extensions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Field Extensions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
        
          
          <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 09 23
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_17">
            <span class="md-nav__icon md-icon"></span>
            2024 09 23
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-09-23/fft-code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FFT Code
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lookup" class="md-nav__link">
    <span class="md-ellipsis">
      Lookup 要解决的问题
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cq" class="md-nav__link">
    <span class="md-ellipsis">
      CQ 的贡献
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      对数导数
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lookup_1" class="md-nav__link">
    <span class="md-ellipsis">
      对数导数 lookup 协议
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pairing-a_i-b_i" class="md-nav__link">
    <span class="md-ellipsis">
      多项式构造和 pairing: 证明 \(a_i\) 和 \(b_i\)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sumcheck" class="md-nav__link">
    <span class="md-ellipsis">
      Sumcheck
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      致谢
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      参考
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="cached-quotients-lookup-arguments">简析 Cached Quotients Lookup Arguments<a class="headerlink" href="#cached-quotients-lookup-arguments" title="Permanent link">&para;</a></h1>
<p>本文来自于  <a href="https://github.com/privacy-scaling-explorations/acceleration-program">PSE Acceleration Program</a> 的赞助支持.</p>
<p>代码: <a href="https://github.com/luckyyang/pylookup/tree/cq_fk/src/cq">pylookup</a></p>
<p>这个代码是参考 CQ 的 paper 实现的, 请看 <code>README.md</code> 了解如何运行.</p>
<p>另外, 其中还包括了一个 <code>cq.ipynb</code> 文件, 是一个 Python notebook 版本的实现, 是一个简化版本的 CQ 实现, 和这个教程比较接近.</p>
<h2 id="lookup">Lookup 要解决的问题<a class="headerlink" href="#lookup" title="Permanent link">&para;</a></h2>
<p>在零知识证明系统中, 通常会利用算数化过程将一个计算问题转化为与之等价的数学表达形式(通常是多项式), 这样就可以利用数学性质来对多项式进行变换, 计算和验证. 这是构建零知识证明的关键步骤, 因为它使得复杂的计算过程可以在数学上被精确地表达和验证.</p>
<p>但有些计算不能被很好的算数化, 或者算数化后会产生更多的约束(多项式). 比如证明一个值是否在一个范围内(<span class="arithmatex">\(0&lt;x&lt;5\)</span>), 可能需要 10 个以上的约束. 这时候使用 Lookup Arguments 能减少约束的数量, 减少生成的证明大小. </p>
<p>Lookup Arguments 允许证明者（prover）证明一个值属于一个预先定义的集合. </p>
<p>拿刚才的例子来说, 证明 <span class="arithmatex">\(0&lt;x&lt;5\)</span> 只需要一个 lookup 约束: <span class="arithmatex">\(x \in \{1, 2, 3, 4\}\)</span>, 即证明 <span class="arithmatex">\(x\)</span> 在表 <span class="arithmatex">\(\{1, 2, 3, 4\}\)</span> 中.</p>
<table>
<thead>
<tr>
<th>Table</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
</tr>
<tr>
<td>2</td>
</tr>
<tr>
<td>3</td>
</tr>
<tr>
<td>4</td>
</tr>
</tbody>
</table>
<p>上面的例子是一个单列的表格. 更进一步, 一个表可以表达任意的关系, 只要对应的输入输出能在表中找到, 我们就可以说 lookup 证明成立.</p>
<table>
<thead>
<tr>
<th>Input 1</th>
<th>Input 2</th>
<th>Input 3</th>
<th>Output</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2</td>
<td>3</td>
<td>6</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>4</td>
<td>24</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>8</td>
<td>48</td>
</tr>
<tr>
<td>4</td>
<td>8</td>
<td>3</td>
<td>13</td>
</tr>
<tr>
<td>13</td>
<td>6</td>
<td>4</td>
<td>33</td>
</tr>
</tbody>
</table>
<p>比如表格第一行我们可以定义为一个加法: <span class="arithmatex">\(1+2+3=6\)</span>, 只要给定的查找是 <span class="arithmatex">\(\{1, 2, 3, 6\}\)</span>, 就满足 lookup 的约束; 第二行可以定义为乘法: <span class="arithmatex">\(2 * 3 * 4 = 24\)</span>, , 只要给定的查找是 <span class="arithmatex">\(\{2, 3, 4, 24\}\)</span>, 就满足 lookup 的约束.</p>
<h2 id="cq">CQ 的贡献<a class="headerlink" href="#cq" title="Permanent link">&para;</a></h2>
<p>从论文中的对比(下图)可以看到, CQ(Cached Quotients Lookup Arguments) 是目前 prover 计算复杂度最低的 lookup argument, 仅为 <span class="arithmatex">\(O(n logn)\)</span>, 这一点通过一定的预处理来实现. 和 Baloo 相比, CQ 有更少的群运算和更小的 proof size.</p>
<p><img alt="Pasted image 20240116145259.png" src="../Pasted%20image%2020240116145259.png" /></p>
<p>CQ 和上表中提到的四个 lookup arguments 主要差别是, CQ 利用了对数导数这个技巧, 让 prover 的计算可以基于原始的大表, 而不需要从大表中提取出一个子表(subtable), 从而让 prover 的计算更加高效.</p>
<p>下面我们针对 CQ 的核心原理进行解释, 如果你对更多的细节和优化感兴趣, 可以参考原始的 paper.</p>
<h2 id="_1">对数导数<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>lookup argument 就是要证明向量/表 <span class="arithmatex">\(\vec f\)</span>  中的元素都在  <span class="arithmatex">\(\vec t\)</span>  中,  这一点和其它 lookup argument 都是一致的.</p>
<p>假设:</p>
<ul>
<li><span class="arithmatex">\(\vec f = \{f_1,  f_2,  f_3,  f_4,  ...,  f_n\}\)</span></li>
<li><span class="arithmatex">\(\vec t = \{t_1,  t_2,  t_3,  t_4, ..,  t_n\}\)</span></li>
</ul>
<p>例如:</p>
<ul>
<li><span class="arithmatex">\(\vec f = \{1,  2,  2,  3,  3,  3\}\)</span></li>
<li><span class="arithmatex">\(\vec t = \{1,  2,  3,  4\}\)</span></li>
</ul>
<p>上面的问题可以转化为一个新的问题: 用这些元素构建一个多项式, 他们拥有相同的根:</p>
<ul>
<li><span class="arithmatex">\(f(x) = (x-1)(x-2)(x-2)(x-3)(x-3)(x-3)\)</span></li>
<li><span class="arithmatex">\(t(x) = (x-1)^1(x-2)^2(x-3)^3(x-4)^0\)</span></li>
</ul>
<p>这样的好处是, 我们可以利用多项式的数学性质进行后续的计算和证明.</p>
<p>注意 <span class="arithmatex">\(t(x)\)</span> 中需要统计 <span class="arithmatex">\(\vec f\)</span> 中出现重复元素的次数,  作为多项式 <span class="arithmatex">\(t(x)\)</span> 对应根的位置的幂次,  没有出现的元素的次数为 0. 可以看到,   <span class="arithmatex">\(\vec f\)</span>  中元素在  <span class="arithmatex">\(\vec t\)</span>  中出现的次数:</p>
<ul>
<li>1 在  <span class="arithmatex">\(\vec t\)</span>  中出现的次数为 1</li>
<li>2 出现次数为 2</li>
<li>3 出现次数为 3</li>
<li>4 出现次数为 0</li>
</ul>
<p>这里可以用一个向量 <span class="arithmatex">\(\vec m\)</span> 表示:</p>
<p><span class="arithmatex">\(\vec m = \{1,  2,  3,  0\}\)</span></p>
<p>所以 <span class="arithmatex">\(t(x)\)</span> 有这样的构造: <span class="arithmatex">\(t(x) = (x-1)^1(x-2)^2(x-3)^3(x-4)^0\)</span>.</p>
<p>可以看到, 如果 <span class="arithmatex">\(f(x)\)</span> 等于 <span class="arithmatex">\(t(x)\)</span> , 就可以说  <span class="arithmatex">\(\vec f\)</span>  中的元素都在  <span class="arithmatex">\(\vec t\)</span>  中, 满足 lookup argument 的证明. </p>
<p>构造连乘的多项式还有一个好处, 可以不用考虑  <span class="arithmatex">\(\vec f\)</span>  和  <span class="arithmatex">\(\vec t\)</span>  两个向量中元素的顺序.</p>
<p>不过实际中通常不会直接对比, 因为:
1.  <span class="arithmatex">\(\vec f\)</span> 通常是秘密的值, 不是公开的, 不能直接对比
2.  <span class="arithmatex">\(\vec f\)</span>  和  <span class="arithmatex">\(\vec t\)</span>  的 size 一般都非常大, 构建的多项式次数很高, 相对难以处理</p>
<p>有没有更好的方式证明 <span class="arithmatex">\(f(x) = t(x)\)</span> 呢?</p>
<p>有. CQ 使用了<a href="https://eprint.iacr.org/2022/1530.pdf">Multivariate lookups based on logarithmic derivatives</a>论文中提到的"对数导数法",  将乘法关系转换为加法关系,  让证明变得简洁了很多.</p>
<p>什么叫对数导数法? </p>
<p>在数学中, 对数导数法是一种求函数导数的技巧, 特别适用于复杂函数的求导, 尤其是当函数是多个函数的乘积形式时. 这种方法通过应用自然对数（<span class="arithmatex">\(ln\)</span>）和链式法则来简化求导过程. </p>
<p>下面我们来计算 <span class="arithmatex">\(f(x) = (x-1)(x-2)^2(x-3)^3\)</span> 的对数导数. 按照对数导数法的步骤, 我们先对 <span class="arithmatex">\(f(x)\)</span> 取对数, 然后对所得表达式求导. 下面是具体的计算步骤:</p>
<p><strong>取对数</strong>:</p>
<p><span class="arithmatex">\(\ln(f(x)) = \ln((x-1)(x-2)(x-2)(x-3)(x-3)(x-3))\)</span></p>
<p><strong>展开对数</strong>（利用对数的性质, 将乘积转换为求和）:</p>
<p><span class="arithmatex">\(\ln(f(x)) = \ln(x-1) + \ln(x-2)+ \ln(x-2)+ \ln(x-3)+ \ln(x-3) + \ln(x-3)\)</span></p>
<p><strong>对等式两边求导</strong>（应用链式法则和基本导数规则）:</p>
<p><span class="arithmatex">\(\frac{d}{dx}\ln(f(x)) = \frac{d}{dx}(\ln(x-1) + \ln(x-2)+ \ln(x-2)+ \ln(x-3)+ \ln(x-3) + \ln(x-3))\)</span></p>
<p>化简为:</p>
<p><span class="arithmatex">\(\frac{f'(x)}{f(x)} = \frac{1}{x-1} + \frac{1}{x-2}+ \frac{1}{x-2} + \frac{1}{x-3} + \frac{1}{x-3} + \frac{1}{x-3}\)</span></p>
<p>即:</p>
<p><span class="arithmatex">\(\frac{f'(x)}{f(x)} = \sum_{j \in |\vec f|} \frac{1}{x-f_j}\)</span></p>
<p>同样对 <span class="arithmatex">\(t(x)\)</span> 求对数导数得到:</p>
<p><span class="arithmatex">\(\frac{t'(x)}{t(x)} = \frac{1}{x-1} + \frac{2}{x-2}+ \frac{3}{x-3}\)</span></p>
<p>即:</p>
<p><span class="arithmatex">\(\frac{t'(x)}{t(x)} = \sum_{i \in |\vec t|} \frac{m_i}{x-t_j}\)</span></p>
<p>所以需要证明:</p>
<p><span class="arithmatex">\(\frac{f'(x)}{f(x)} = \frac{t'(x)}{t(x)}\)</span></p>
<p>即:</p>
<p><span class="arithmatex">\(\sum_{j \in |\vec f|} \frac{1}{x-f_j} = \sum_{i \in |\vec t|} \frac{m_i}{x-t_i}\)</span></p>
<p>简化一下写法, 定义 <span class="arithmatex">\(a_i = m_i / (x - t_i)\)</span> 和  <span class="arithmatex">\(b_j = 1 / (x - f_j)\)</span>, </p>
<p>即需要证明:</p>
<p><span class="arithmatex">\(\sum_i a_i = \sum_j b_j\)</span> </p>
<p>可以看到这个过程将多个函数的乘积转换为求和的形式. 最终将 lookup 证明转换为证明对数导数(<span class="arithmatex">\(\frac{f'(x)}{f(x)}\)</span> 和 <span class="arithmatex">\(\frac{t'(x)}{t(x)}\)</span>) 相等.</p>
<h2 id="lookup_1">对数导数 lookup 协议<a class="headerlink" href="#lookup_1" title="Permanent link">&para;</a></h2>
<p>通过上面的对数导数可以构建一个简单的 lookup argument:</p>
<ul>
<li>prover 给 verifier 发送 <span class="arithmatex">\(\vec f, \vec t, \vec m\)</span></li>
<li>verifier 给 prover 发送随机数 <span class="arithmatex">\(\beta\)</span></li>
<li>prover 给 verifier 发送多个值:  <span class="arithmatex">\(a_i = m_i / (\beta - t_i)\)</span> 和  <span class="arithmatex">\(b_j = 1 / (\beta - f_j)\)</span>,  其中 <span class="arithmatex">\(i\)</span> 和 <span class="arithmatex">\(j\)</span> 的取值范围为 <span class="arithmatex">\(\vec t\)</span> 和 <span class="arithmatex">\(\vec f\)</span> 中元素的个数, 即 <span class="arithmatex">\(i \in |\vec t|, j \in |\vec f|\)</span> </li>
<li>
<p>verifier 做三种检查</p>
<ul>
<li><span class="arithmatex">\(a_i\)</span> 值检查: <span class="arithmatex">\(a_i * (\beta - t_i) = m_i\)</span> </li>
<li><span class="arithmatex">\(b_i\)</span> 值检查: <span class="arithmatex">\(b_i * (\beta - f_i) = 1\)</span> </li>
<li>sum 检查: <span class="arithmatex">\(\sum_i a_i = \sum_j b_j\)</span> </li>
</ul>
</li>
</ul>
<p>对于 <span class="arithmatex">\(a_i\)</span> 和 <span class="arithmatex">\(b_i\)</span> 的检查, 上面的 lookup 协议有一个问题, 就是 proof size 比较大, 因为需要将所有的 <span class="arithmatex">\(a_i\)</span> 和 <span class="arithmatex">\(b_i\)</span> 值都发给 verifier. 要解决这个问题, 我们可以利用 Schwartz-Zippel 定理, 将所有 <span class="arithmatex">\(a_i\)</span> 和 <span class="arithmatex">\(b_i\)</span> 的值编码到多项式中, 然后 verifier 只需要发送一个随机值进行验证就可以保证 prover 提供的所有 <span class="arithmatex">\(a_i\)</span> 和 <span class="arithmatex">\(b_i\)</span> 的值是正确的. </p>
<p>对于 sum 检查, 我们可以直接使用 univariate sumcheck.</p>
<p>下面我们分别看看如何构造对应的证明.</p>
<h2 id="pairing-a_i-b_i">多项式构造和 pairing: 证明  <span class="arithmatex">\(a_i\)</span> 和 <span class="arithmatex">\(b_i\)</span><a class="headerlink" href="#pairing-a_i-b_i" title="Permanent link">&para;</a></h2>
<p>为了验证:</p>
<ul>
<li><span class="arithmatex">\(a_i\)</span> 的正确性: <span class="arithmatex">\(a_i * (t_i - \beta) = m_i\)</span> </li>
<li><span class="arithmatex">\(b_i\)</span> 的正确性: <span class="arithmatex">\(b_i * (f_i - \beta) = 1\)</span> </li>
</ul>
<p>我们通过将 <span class="arithmatex">\(a_i\)</span> 和 <span class="arithmatex">\(b_i\)</span> 分别构造成一个多项式, 然后利用多项式的性质来进行验证.</p>
<p>所以需要:</p>
<ul>
<li>从  <span class="arithmatex">\(a_i\)</span> 构建出多项式 <span class="arithmatex">\(A(x)\)</span>, 并验证构造的正确性</li>
<li>从  <span class="arithmatex">\(b_i\)</span> 构建出多项式 <span class="arithmatex">\(B(x)\)</span>, 并验证构造的正确性</li>
</ul>
<p>构造多项式我们通常使用拉格朗日插值法. 这就需要构造一系列 <span class="arithmatex">\(\{x_i, y_i\}\)</span> 值对, 将这些值对插值成多项式, 通常 <span class="arithmatex">\(\{x_i\}\)</span> 的值来自于一个乘法子群, 群的大小为 <span class="arithmatex">\(\{y_i\}\)</span> 的大小, 这里分别为 <span class="arithmatex">\(|\vec t|\)</span> 和 <span class="arithmatex">\(|\vec f|\)</span></p>
<p>如何构造 <span class="arithmatex">\(A(x)\)</span>? </p>
<ol>
<li>verifier 发送随机数 <span class="arithmatex">\(\beta\)</span>, 令 <span class="arithmatex">\(x =  \beta\)</span></li>
<li>选择大小为 <span class="arithmatex">\(|\vec t|\)</span> 的乘法子群  <span class="arithmatex">\(H_t = \{\omega_i\}\)</span>,  <span class="arithmatex">\(i \in |\vec t|\)</span></li>
<li><span class="arithmatex">\(A(\omega_i) = a_i = m_i / (t_i - \beta)\)</span>.  <span class="arithmatex">\(\{x_i, y_i\}\)</span> 值对为  <span class="arithmatex">\(\{\omega_i, a_i\}\)</span> </li>
<li>使用拉格朗日插值法得到多项式 <span class="arithmatex">\(A(x)\)</span></li>
</ol>
<p>如何检查 <span class="arithmatex">\(A(x)\)</span> 被正确构造?</p>
<ol>
<li>分别对 <span class="arithmatex">\(\vec m\)</span> 和 <span class="arithmatex">\(\vec t\)</span> 在乘法子群上进行插值得到多项式 <span class="arithmatex">\(M(x), T(x)\)</span></li>
<li>在乘法子群  <span class="arithmatex">\(H_t\)</span> 上, 多项式满足 <span class="arithmatex">\(A(x) = M(x)/(T(x) - \beta)\)</span></li>
<li>变换为 <span class="arithmatex">\(A(x)(T(x) - \beta) - M(x) = 0\)</span></li>
<li>由多项式余式定理得到 <span class="arithmatex">\(A(x)(T(x) - \beta) - M(x) = Q_A(x) * Z_A(x)\)</span>. 这个等式对 <span class="arithmatex">\(x\)</span> 为群上的任意值都成立. 其中 <span class="arithmatex">\(Q_A(x)\)</span> 为商多项式, <span class="arithmatex">\(Z_A(x) = \prod_i(x - \omega_i)\)</span> 为消失多项式</li>
<li>prover 发送<ol>
<li><span class="arithmatex">\(A(x)\)</span> 的承诺 <span class="arithmatex">\([A(x)]_1\)</span></li>
<li><span class="arithmatex">\(Q_A(x)\)</span> 的承诺 <span class="arithmatex">\([Q_A(x)]_1\)</span></li>
<li><span class="arithmatex">\(M(x)\)</span> 的承诺 <span class="arithmatex">\([M(x)]_1\)</span></li>
</ol>
</li>
<li>verifier 自行计算 <span class="arithmatex">\(T(x)\)</span> 的承诺 <span class="arithmatex">\([T(x)]_2\)</span> 和  <span class="arithmatex">\(Z_A(x)\)</span> 的承诺 <span class="arithmatex">\([Z_A(x)]_2\)</span>, 然后通过椭圆曲线的 pairing 进行 KZG  验证: <span class="arithmatex">\(e([T(x)]_2, [A(x)]_1) = e([1]_2, [A(x)]_1 * \beta + [M(x)]_1) * e([Z_A(x)]_2, [Q_A(x)]_1)\)</span></li>
</ol>
<p>注意: 和 paper 有些区别的地方是, 为了方便解释, 文章中有些地方使用了 <span class="arithmatex">\(-\)</span> 号而不是 <span class="arithmatex">\(+\)</span> 号, 这是因为在群上做减法运算会转化成加法运算, 比如对于 <span class="arithmatex">\(modulus = 5\)</span> 的群, <span class="arithmatex">\(\beta=-2\%5 = 3\)</span>, 所以  <span class="arithmatex">\((x - 2)\%5 = x + 3\)</span>, 我们随时可以将减法转化为加法表示, 因此在符号表示上, 在有些场景下不做区分.</p>
<p>同样的方法构造 <span class="arithmatex">\(B(x)\)</span>:</p>
<ol>
<li>verifier 发送随机数 <span class="arithmatex">\(\beta\)</span>, 令 <span class="arithmatex">\(x = \beta\)</span></li>
<li>选择大小为 <span class="arithmatex">\(|\vec f|\)</span> 的乘法子群 <span class="arithmatex">\(H_f = \{\omega_j\}\)</span>, <span class="arithmatex">\(j \in |\vec f|\)</span></li>
<li><span class="arithmatex">\(B(\omega_j) = b_j = 1 / (f_j - \beta)\)</span>. <span class="arithmatex">\(\{x_j, y_j\}\)</span> 值对为 <span class="arithmatex">\(\{\omega_j, b_j\}\)</span></li>
<li>使用拉格朗日插值法得到多项式 <span class="arithmatex">\(B(x)\)</span></li>
</ol>
<p>检查 <span class="arithmatex">\(B(x)\)</span> 被正确构造:</p>
<ol>
<li>对 <span class="arithmatex">\(\vec f\)</span> 在乘法子群上进行插值得到多项式 <span class="arithmatex">\(F(x)\)</span></li>
<li>在乘法子群 <span class="arithmatex">\(H_f\)</span> 上, 多项式满足 <span class="arithmatex">\(B(x) = 1/(F(x) - \beta)\)</span></li>
<li>变换为 <span class="arithmatex">\(B(x)(F(x) - \beta) - 1 = 0\)</span></li>
<li>由多项式余式定理得到 <span class="arithmatex">\(B(x)(F(x) - \beta) - 1 = Q_B(x) * Z_B(x)\)</span>. 这个等式对 <span class="arithmatex">\(x\)</span> 为群上的任意值都成立. 其中 <span class="arithmatex">\(Q_B(x)\)</span> 为商多项式, <span class="arithmatex">\(Z_B(x) = \prod_j(x - \omega_j)\)</span> 为消失多项式</li>
<li>prover 发送<ol>
<li><span class="arithmatex">\(B(x)\)</span> 的承诺 <span class="arithmatex">\([B(x)]_1\)</span></li>
<li><span class="arithmatex">\(Q_B(x)\)</span> 的承诺 <span class="arithmatex">\([Q_B(x)]_1\)</span></li>
<li><span class="arithmatex">\(F(x)\)</span> 的承诺 <span class="arithmatex">\([F(x)]_1\)</span></li>
</ol>
</li>
<li>verifier 自行计算 <span class="arithmatex">\(Z_B(x)\)</span> 的承诺 <span class="arithmatex">\([Z_B(x)]_2\)</span>, 然后通过椭圆曲线的 pairing 进行验证: <span class="arithmatex">\(e([F(x)]_2, [B(x)]_1) = e([1]_2, [B(x)]_1 * \beta + [1]_1) * e([Z_B(x)]_2, [Q_B(x)]_1)\)</span></li>
</ol>
<p>注意: paper 中的验证对计算过程进行了一定的优化, 我们这里为了叙述方便, 没有使用和 paper 中一样的验证方式, 不过核心原理是一样的, 都是通过 pairing 进行 KZG 验证.</p>
<p><span class="arithmatex">\(B(x)\)</span> 还需要做更进一步的检查, 检查多项式的阶数是正确的, 具体方式是:</p>
<ul>
<li>另 <span class="arithmatex">\(N = |\vec t|, n = |\vec f|\)</span></li>
<li>prover 发送<ul>
<li><span class="arithmatex">\(B(x)\)</span> 的承诺 <span class="arithmatex">\(b = [B(x)]_1\)</span></li>
<li><span class="arithmatex">\(X^{N−1−(n−1)}\)</span> 的承诺 <span class="arithmatex">\(r = [X^{N−1−(n−1)}]_2\)</span></li>
<li><span class="arithmatex">\(P(x)\)</span> 的承诺 <span class="arithmatex">\(p = [P(x)]_2\)</span>, <span class="arithmatex">\(P(X) := B(X) * X^{N−1−(n−1)}\)</span></li>
</ul>
</li>
<li>verifier 验证: <span class="arithmatex">\(e(b, r) = e(p, [1]_2)\)</span></li>
</ul>
<p>论文在这里进行了一定的优化, 使用的是 <span class="arithmatex">\(B_0(x)\)</span> 而不是 <span class="arithmatex">\(B(x)\)</span>, 不过目标是一样的, 都是为了做项式的阶数检查.</p>
<h2 id="sumcheck">Sumcheck<a class="headerlink" href="#sumcheck" title="Permanent link">&para;</a></h2>
<p>接下来我们要验证 sum 成立: <span class="arithmatex">\(\sum_i a_i = \sum_j b_j\)</span> </p>
<p>前面证明了左右两边每一项都是正确的, 那下面需要证明左右两边的加和是正确的, 也就是需要彼此相等. 证明的方法是 sumcheck. 可以利用这样一个引理来证明:</p>
<div class="arithmatex">\[
\sum_{a \in H} f(a) = t \cdot f(0)
\]</div>
<p>其中:</p>
<ul>
<li><span class="arithmatex">\(H\)</span> 为乘法子群: <span class="arithmatex">\(H=\{1, \omega, \omega^2, ..., \omega^{t-2}, \omega^{t-1} \}\)</span>,  <span class="arithmatex">\(t\)</span> 是 <span class="arithmatex">\(H\)</span> 中元素的个数, <span class="arithmatex">\(t=|H|\)</span>, <span class="arithmatex">\(\omega\)</span> 是单位根 </li>
<li><span class="arithmatex">\(f(x)\)</span> 为一个多项式, <span class="arithmatex">\(f(x) = f_0 + f_1x + f_2x^2 + ... + f_{t-2}x^{t-2} + f_{t-1}x^{t-1}\)</span></li>
</ul>
<p>让我们来分解一下计算过程, 将 <span class="arithmatex">\(a\)</span> 取 <span class="arithmatex">\(H\)</span> 中的值带入 <span class="arithmatex">\(f(x)\)</span> 可得:</p>
<div class="arithmatex">\[
\begin{align*}
&amp; \sum_{a \in H} f(a) = f(1) + f(\omega) + f(\omega^2) + ... + + f(\omega^t-1) \\
&amp; \\
&amp; \\
&amp; = f_0 + f_1 + f_2 + ... + f_{t-2} + f_{t-1} \\
&amp; + f_0 + f_1\omega + f_2\omega^2 + ... + f_{t-2}\omega^{t-2} + f_{t-1}\omega^{t-1} \\
&amp; + f_0 + f_1(\omega^2) + f_2(\omega^2)^2 + ... + f_{t-2}(\omega^2)^{t-2} + f_{t-1}(\omega^2)^{t-1} \\
&amp; . \\
&amp; . \\
&amp; . \\
&amp; + f_0 + f_1(\omega^{t-2}) + f_2(\omega^{t-2})^2 + ... + f_{t-2}(\omega^{t-2})^{t-2} + f_{t-1}(\omega^{t-2})^{t-1} \\
&amp; + f_0 + f_1(\omega^{t-1}) + f_2(\omega^{t-1})^2 + ... + f_{t-2}(\omega^{t-1})^{t-2} + f_{t-1}(\omega^{t-1})^{t-1} \\
&amp; \\
&amp; \\
&amp; = t \cdot f_0 + f_1\sum_{i \in t}(\omega)^i + f_2\sum_{i \in t}(\omega^2)^i + ... + f_{t-2}\sum_{i \in t}(\omega^{t-2})^i + f_{t-1}\sum_{i \in t}(\omega^{t-1})^i \\
\end{align*}
\]</div>
<p>上面公式中, 除了第一项, 后面的 <span class="arithmatex">\(t-1\)</span> 项每个 <span class="arithmatex">\(sum\)</span> 都为 0. 这是因为, 每个 <span class="arithmatex">\(\omega^i\)</span> 都是有限域上乘法子群中的元素, 而乘法子群中每个元素都可以作为乘法子群的生成元, 也就说明后面的 <span class="arithmatex">\(t-1\)</span> 项的每个 <span class="arithmatex">\(sum\)</span> 都是乘法子群中所有元素的 <span class="arithmatex">\(sum\)</span>. </p>
<p>有限域上的乘法子群与复数域上的单位圆结构类似. 在单位圆上:</p>
<ul>
<li>所有元素都由单位元生成并均匀分布在单位圆上</li>
<li>每个元素基于原点都有另外一个对称的点, 这两点复平面上的矢量和抵消, 加和等于 0 </li>
</ul>
<p>因此所有单位圆的元素 <span class="arithmatex">\(sum\)</span> 等于 0.</p>
<p>因为要使用FFT(Fast Fourier Transform)做多项式的插值, 所以要求乘法子群的元素个数是 2 的幂次个. 在乘法子群中, 每个元素也有对称的点, 对于拥有 <span class="arithmatex">\(t\)</span> 个元素的乘法子群 <span class="arithmatex">\(H\)</span>: <span class="arithmatex">\(H_i + H_{i+t/2} = 0\)</span>, 这两个对称的点相加等于 0, 所以乘法子群所有元素的 <span class="arithmatex">\(sum\)</span> 也等于 0. 这就是为什么后面的 <span class="arithmatex">\(t-1\)</span> 项每个 <span class="arithmatex">\(sum\)</span> 都为 0:</p>
<div class="arithmatex">\[
\begin{align*}
&amp; \sum_{i \in t}(\omega)^i = 0\\
&amp; \sum_{i \in t}(\omega^2)^i = 0 \\
&amp; . \\
&amp; . \\
&amp; . \\
&amp; \sum_{i \in t}(\omega^{t-2})^i = 0 \\
&amp; \sum_{i \in t}(\omega^{t-1})^i = 0 \\
\end{align*}
\]</div>
<p>所以:</p>
<div class="arithmatex">\[
\begin{align*}
&amp; \sum_{a \in H} f(a) \\
&amp; = t \cdot f_0 + f_1\sum_{i \in t}(\omega)^i + f_2\sum_{i \in t}(\omega^2)^i + ... + f_{t-2}\sum_{i \in t}(\omega^{t-2})^i + f_{t-1}\sum_{i \in t}(\omega^{t-1})^i \\
&amp; = t \cdot f_0 + f_1 \cdot 0 + f_2 \cdot 0 + ... + f_{t-2} \cdot 0 + f_{t-1} \cdot 0 \\
&amp; = t \cdot f_0
\end{align*}
\]</div>
<p>所以:</p>
<p><span class="arithmatex">\(\sum_{x \in H_t} A(x) = |\vec t| \cdot A(0)\)</span></p>
<p><span class="arithmatex">\(\sum_{x \in H_f} B(x) = |\vec f| \cdot B(0)\)</span></p>
<p>我们只需要验证下面的关系是否成立: </p>
<p><span class="arithmatex">\(|\vec t| \cdot A(0) \stackrel{?}{=} |\vec f| \cdot B(0)\)</span></p>
<p>最终, 我们通过这三个证明就完成了 CQ 要证明的 lookup.</p>
<h2 id="_2">致谢<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<ul>
<li>Guo Yu</li>
<li>Yu-Ming Hsu</li>
<li>Jing-Jie Wang</li>
<li>Paul Yu</li>
<li>Even</li>
<li>阿咪咪小熊</li>
</ul>
<h2 id="_3">参考<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://eprint.iacr.org/2022/1763">cq: Cached quotients for fast lookups</a></li>
<li><a href="https://www.youtube.com/@thebiuresearchcenteronappl8783">A Close Look at a Lookup Argument - Mary Maller</a></li>
<li><a href="https://github.com/sec-bit/learning-zkp/blob/develop/plonk-intro-cn/7-plonk-lookup.md">理解 PLONK（七）：Lookup Gate</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
      
    
  </body>
</html>

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../2023-12-09/lookup-arguments-overview/">
      
      
        <link rel="next" href="../../2024-01-06/joy/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.36">
    
    
      
        <title>椭圆曲线(Elliptic Curve)的神奇性质 - Harry's Notes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.06209087.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/font.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#elliptic-curve" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Harry&#39;s Notes" class="md-header__button md-logo" aria-label="Harry's Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Harry's Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              椭圆曲线(Elliptic Curve)的神奇性质
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Harry&#39;s Notes" class="md-nav__button md-logo" aria-label="Harry's Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Harry's Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2023 12 05
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            2023 12 05
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023-12-05/thoughts-about-community/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    如何做好社区？在伊斯坦布尔 Devconnect 期间的思考
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2023 12 06
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            2023 12 06
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023-12-06/publish-obsidian-notes-to-website/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    如何发布一个 Obsidian 的笔记网站
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2023 12 07
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            2023 12 07
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023-12-07/zkp-space-lookups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Twitter space: Lookups
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2023 12 09
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            2023 12 09
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023-12-09/lookup-arguments-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lookup Arguments Overview
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2023 12 25
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            2023 12 25
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    椭圆曲线(Elliptic Curve)的神奇性质
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    椭圆曲线(Elliptic Curve)的神奇性质
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      椭圆曲线的应用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="椭圆曲线的应用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      签名
    </span>
  </a>
  
    <nav class="md-nav" aria-label="签名">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      给任何消息签名
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      给以太坊交易签名
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      秘钥交换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      费马大定理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ecc" class="md-nav__link">
    <span class="md-ellipsis">
      椭圆曲线密码学(ECC) 的优势
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      椭圆曲线——“一根神线”
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      实数域上的椭圆曲线
    </span>
  </a>
  
    <nav class="md-nav" aria-label="实数域上的椭圆曲线">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#group" class="md-nav__link">
    <span class="md-ellipsis">
      群(Group)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      计算
    </span>
  </a>
  
    <nav class="md-nav" aria-label="计算">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      加法的几何计算法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      加法的代数算法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalar-multiplication" class="md-nav__link">
    <span class="md-ellipsis">
      乘法：Scalar multiplication 标量乘法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      有限域上的椭圆曲线
    </span>
  </a>
  
    <nav class="md-nav" aria-label="有限域上的椭圆曲线">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      计算
    </span>
  </a>
  
    <nav class="md-nav" aria-label="计算">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      加法：几何上
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      加法：代数上
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#order" class="md-nav__link">
    <span class="md-ellipsis">
      椭圆曲线的阶(order)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      标量乘法和循环子群
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      如何寻找循环子群的阶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generator" class="md-nav__link">
    <span class="md-ellipsis">
      如何寻找 generator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      参考
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 01 06
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            2024 01 06
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-01-06/joy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    我的人生哲学: 快乐理论
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 01 23
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            2024 01 23
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-01-23/cq-en/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    An Introduction to Cached Quotients Lookup Arguments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-01-23/cq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    简析 Cached Quotients Lookup Arguments
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 05 16
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            2024 05 16
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-05-16/jolt-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notes about Jolt
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 05 28
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            2024 05 28
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-05-28/bit-commitment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How bit commitment works
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 05 29
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            2024 05 29
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-05-29/bitvm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BitVM 介绍
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 05 30
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            2024 05 30
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-05-30/why-no-zk-in-bitcoin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Why There’s No ZK in Bitcoin: The Missing Pieces
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 06 01
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            2024 06 01
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-06-01/bitvm-script/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BitVM Script
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 06 23
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            2024 06 23
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-06-23/commutative-algebra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    交换代数学习笔记
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 09 03
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            2024 09 03
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-09-03/Drawing-root-of-unity-complex-n4.excalidraw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drawing root of unity complex n4.excalidraw
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-09-03/Drawing-root-of-unity-complex-n8.excalidraw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drawing root of unity complex n8.excalidraw
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-09-03/Drawing-root-of-unity-group-n16.excalidraw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drawing root of unity group n16.excalidraw
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-09-03/roots-of-unity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roots of Unity: An Introduction
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 09 11
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            2024 09 11
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-09-11/field-extensions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Field Extensions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
        
          
          <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2024 09 23
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_17">
            <span class="md-nav__icon md-icon"></span>
            2024 09 23
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024-09-23/fft-code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FFT Code
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      椭圆曲线的应用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="椭圆曲线的应用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      签名
    </span>
  </a>
  
    <nav class="md-nav" aria-label="签名">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      给任何消息签名
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      给以太坊交易签名
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      秘钥交换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      费马大定理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ecc" class="md-nav__link">
    <span class="md-ellipsis">
      椭圆曲线密码学(ECC) 的优势
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      椭圆曲线——“一根神线”
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      实数域上的椭圆曲线
    </span>
  </a>
  
    <nav class="md-nav" aria-label="实数域上的椭圆曲线">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#group" class="md-nav__link">
    <span class="md-ellipsis">
      群(Group)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      计算
    </span>
  </a>
  
    <nav class="md-nav" aria-label="计算">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      加法的几何计算法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      加法的代数算法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalar-multiplication" class="md-nav__link">
    <span class="md-ellipsis">
      乘法：Scalar multiplication 标量乘法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      有限域上的椭圆曲线
    </span>
  </a>
  
    <nav class="md-nav" aria-label="有限域上的椭圆曲线">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      计算
    </span>
  </a>
  
    <nav class="md-nav" aria-label="计算">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      加法：几何上
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      加法：代数上
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#order" class="md-nav__link">
    <span class="md-ellipsis">
      椭圆曲线的阶(order)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      标量乘法和循环子群
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      如何寻找循环子群的阶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generator" class="md-nav__link">
    <span class="md-ellipsis">
      如何寻找 generator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      参考
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="elliptic-curve">椭圆曲线(Elliptic Curve)的神奇性质<a class="headerlink" href="#elliptic-curve" title="Permanent link">&para;</a></h1>
<h2 id="_1">椭圆曲线的应用<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="_2">签名<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>利用椭圆曲线的签名算法叫做 ECDSA (Elliptic Curve Digital Signature Algorithm)。</p>
<h4 id="_3">给任何消息签名<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>https://app.mycrypto.com/sign-message
<img alt="Pasted image 20231225103113.png" src="../Pasted%20image%2020231225103113.png" />
<div class="highlight"><pre><span></span><code>{
    &quot;address&quot;: &quot;0x32197ff73E5A309f51Bd94F1728DbFE2BED452b0&quot;,
    &quot;msg&quot;: &quot;Hello EC!&quot;,
    &quot;sig&quot;: &quot;0xc79ad7b9a57fdd9b0f1e3c7dd7910f3042a57848d51f399caa8c755c80bd03267d9d9cdf2d10361a0d5cc2096c74837bc33c7dea3369982b405f963bbb1806921c&quot;,
    &quot;version&quot;: &quot;2&quot;
}
</code></pre></div></p>
<p><img alt="Pasted image 20231225103220.png" src="../Pasted%20image%2020231225103220.png" />
参考 https://medium.com/mycrypto/the-magic-of-digital-signatures-on-ethereum-98fe184dc9c7</p>
<h4 id="_4">给以太坊交易签名<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20231225103617.png" src="../Pasted%20image%2020231225103617.png" />
给交易签名本质上也是签署一个特定的信息。只不过可以把签署后的交易发到区块链上，链上签名验证通过后，可以执行相关的代码，比如转账等。</p>
<h3 id="_5">秘钥交换<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>参考 https://andrea.corbellini.name/2015/05/30/elliptic-curve-cryptography-ecdh-and-ecdsa/</p>
<p>利用椭圆曲线的秘钥交换叫做 ECDH (Elliptic curve Diffie-Hellman)。</p>
<p>过程：</p>
<ol>
<li>首先，Alice 和 Bob 生成他们自己的私钥和公钥</li>
<li>Alice 和 Bob 通过不安全的通道交换他们的公钥</li>
<li>Alice 计算 <span class="arithmatex">\(S=d_AH_B\)</span> ，Bob 计算  <span class="arithmatex">\(S=d_BH_A\)</span></li>
</ol>
<p><img alt="Pasted image 20231225104601.png" src="../Pasted%20image%2020231225104601.png" /></p>
<p>S 就是获得的共享秘钥，只有他们两人知道，之后他们就可以用 S 进行加密和解密。</p>
<p>Code:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Alice generates her own keypair.</span>

<span class="n">alice_private_key</span><span class="p">,</span> <span class="n">alice_public_key</span> <span class="o">=</span> <span class="n">make_keypair</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Alice&#39;s private key:&quot;</span><span class="p">,</span> <span class="nb">hex</span><span class="p">(</span><span class="n">alice_private_key</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Alice&#39;s public key: (0x</span><span class="si">{:x}</span><span class="s2">, 0x</span><span class="si">{:x}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">alice_public_key</span><span class="p">))</span>



<span class="c1"># Bob generates his own key pair.</span>

<span class="n">bob_private_key</span><span class="p">,</span> <span class="n">bob_public_key</span> <span class="o">=</span> <span class="n">make_keypair</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bob&#39;s private key:&quot;</span><span class="p">,</span> <span class="nb">hex</span><span class="p">(</span><span class="n">bob_private_key</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bob&#39;s public key: (0x</span><span class="si">{:x}</span><span class="s2">, 0x</span><span class="si">{:x}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">bob_public_key</span><span class="p">))</span>



<span class="c1"># Alice and Bob exchange their public keys and calculate the shared secret.</span>

<span class="n">s1</span> <span class="o">=</span> <span class="n">scalar_mult</span><span class="p">(</span><span class="n">alice_private_key</span><span class="p">,</span> <span class="n">bob_public_key</span><span class="p">)</span>

<span class="n">s2</span> <span class="o">=</span> <span class="n">scalar_mult</span><span class="p">(</span><span class="n">bob_private_key</span><span class="p">,</span> <span class="n">alice_public_key</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">s1</span> <span class="o">==</span> <span class="n">s2</span>



<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Shared secret: (0x</span><span class="si">{:x}</span><span class="s1">, 0x</span><span class="si">{:x}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">s1</span><span class="p">))</span>
</code></pre></div>
<p>Result:
<div class="highlight"><pre><span></span><code>Alice<span class="s1">&#39;s private key: 0x4f637def8cd2bffd769fedf79f65656780e1701f9b64d26ea8a5c6729e02ea16</span>

<span class="s1">Alice&#39;</span>s<span class="w"> </span>public<span class="w"> </span>key:<span class="w"> </span><span class="o">(</span>0x4a1ae99a3451ba1fadfdf7b4705c3568cd5ecc5c4c21e9f86ce3ae5166fc2d25,<span class="w"> </span>0xabb6fdaaadc42a83ee3bd761af7950bbe81624da7153af2e538a1538ad8aff55<span class="o">)</span>

Bob<span class="s1">&#39;s private key: 0xc64fda9723d8a7380d0a78becf2f161e41cecc61bdd39795bd94dc5894f81382</span>

<span class="s1">Bob&#39;</span>s<span class="w"> </span>public<span class="w"> </span>key:<span class="w"> </span><span class="o">(</span>0xfb47290bd33fdbd133b40bd4df078cb2231e9a7854cb18dc10fd183f7cedac55,<span class="w"> </span>0xf20e82a1b020f4c2ca712d11c1ed9b64fc7e60df657c5e0223a48c79dd6809fa<span class="o">)</span>

Shared<span class="w"> </span>secret:<span class="w"> </span><span class="o">(</span>0x6e7b7773764d62ed36000f09c7db1b66a5341d29c2c10c395ded5d5ec97eb9cf,<span class="w"> </span>0x507aea85dee2ba199692b0a5ff3fb017e5f4179b2012065a9912a8f7851056d1<span class="o">)</span>
</code></pre></div></p>
<h3 id="_6">费马大定理<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>悬而未决350多年的著名数学难题“费马猜想”(即“费马大定理”)，就是由英国数学家Andrew Wiles(现为美国普林斯顿大学教授)于1994年应用椭圆曲线的理论而彻底解决的。</p>
<h2 id="ecc">椭圆曲线密码学(ECC) 的优势<a class="headerlink" href="#ecc" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>RSA key size (bits)</th>
<th>ECC key size (bits)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1024</td>
<td>160</td>
</tr>
<tr>
<td>2048</td>
<td>224</td>
</tr>
<tr>
<td>3072</td>
<td>256</td>
</tr>
<tr>
<td>7680</td>
<td>384</td>
</tr>
<tr>
<td>15360</td>
<td>521</td>
</tr>
</tbody>
</table>
<p>ECC 使用更少的内存，而且密钥生成和签名的速度要快得多。不过RSA 密钥大小和 ECC 密钥大小之间不存在线性关系。</p>
<h2 id="_7">椭圆曲线——“一根神线”<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<p><img alt="Pasted image 20231225110236.png" src="../Pasted%20image%2020231225110236.png" />
<img alt="Pasted image 20231225110326.png" src="../Pasted%20image%2020231225110326.png" /></p>
<p>椭圆曲线的理论及其应用作为现代数论中的一个分支学科，可以说是集纯粹性、优美性、挑战 性、应用性、实用性为一体的一个“突出例子”，如果说“数论是数学的皇后”(高斯的名言)的话，那么椭圆曲线理论就是皇后的皇冠上的一颗闪亮的“明珠”.</p>
<h2 id="_8">实数域上的椭圆曲线<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<p>定义：</p>
<p><span class="arithmatex">\(y^2 = x^3 + ax + b\)</span> </p>
<p>其中 <span class="arithmatex">\(4a^3 + 27b^2 \neq 0\)</span></p>
<p>再加上一个无穷远点，也可以理解为 0 点：A + 0 = 0 + A = A</p>
<p><img alt="Pasted image 20231225111045.png" src="../Pasted%20image%2020231225111045.png" /></p>
<h3 id="group">群(Group)<a class="headerlink" href="#group" title="Permanent link">&para;</a></h3>
<p>之所以介绍群，是因为群有很多优美的性质，可以把椭圆曲线定义成一个群，这样椭圆曲线就可以直接利用群的性质。</p>
<p>群的性质:
<img alt="Pasted image 20231225111721.png" src="../Pasted%20image%2020231225111721.png" /></p>
<p>比如，在数的乘法下，所有正有理数和正实数都分别构成 一个乘法群，但所有正整数不能构成一个群，因为性质 (3)不成立.</p>
<p>再比如，在数的加法下，所有整数、所有有理数，所有实数，和所有复数都分别构成一个加法群(Additive Group).</p>
<p>如何在椭圆曲线上定义一个群：</p>
<ul>
<li>该群的元素是椭圆曲线的点；</li>
<li>单位元是无穷远 0 处的点；</li>
<li>点 P 的倒数是关于 x 轴对称的点；</li>
<li>加法由以下规则给出：给定三个对齐的非零点 P、Q、R ，它们的总和为 P + Q + R = 0 。</li>
</ul>
<p><img alt="Pasted image 20231225112226.png" src="../Pasted%20image%2020231225112226.png" /></p>
<h3 id="_9">计算<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<h4 id="_10">加法的几何计算法<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20231225112310.png" src="../Pasted%20image%2020231225112310.png" /></p>
<p>P + Q + R = 0 =&gt; P + Q = -R</p>
<p>通过 P 和 Q 绘制直线。该线与椭圆曲线第三个点 R 相交。与之对称的点 −R 是 
P+Q 的结果。</p>
<h4 id="_11">加法的代数算法<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20231225112620.png" src="../Pasted%20image%2020231225112620.png" />
<img alt="Pasted image 20231225112636.png" src="../Pasted%20image%2020231225112636.png" />
例子：</p>
<p>曲线 <span class="arithmatex">\(y^2 = x^3 - 7x + 10\)</span> </p>
<p>P = (1, 2), Q = (3, 4)
<img alt="Pasted image 20231225112851.png" src="../Pasted%20image%2020231225112851.png" /></p>
<p>P + Q = -R = (-3, 2)</p>
<p>验证发现这个点也在椭圆曲线上。</p>
<p>Try https://andrea.corbellini.name/ecc/interactive/reals-add.html</p>
<h4 id="scalar-multiplication">乘法：Scalar multiplication 标量乘法<a class="headerlink" href="#scalar-multiplication" title="Permanent link">&para;</a></h4>
<p>椭圆曲线不支持点和点之间的乘法( P * Q)，只支持标量乘法：
<img alt="Pasted image 20231225113316.png" src="../Pasted%20image%2020231225113316.png" />
其中 n 为自然数。</p>
<p>标量乘法可以转换为加法。</p>
<p>不过直接加的算法复杂度是 <span class="arithmatex">\(O(2^k)\)</span>（如果 n 是 k 个二进制数）。</p>
<p>优化: <strong>double and add</strong> 算法</p>
<p>例如 n=151 。其二进制表示为 <span class="arithmatex">\(10010111_2\)</span> 。这种二进制表示可以转化为 2 的幂和
<img alt="Pasted image 20231225113703.png" src="../Pasted%20image%2020231225113703.png" />
<img alt="Pasted image 20231225113727.png" src="../Pasted%20image%2020231225113727.png" /></p>
<p>七次加倍和四次加法</p>
<h2 id="_12">有限域上的椭圆曲线<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<p><img alt="Pasted image 20231225114033.png" src="../Pasted%20image%2020231225114033.png" /></p>
<p>p 为素数。</p>
<p>有限域上的计算：
<img alt="Pasted image 20231225114608.png" src="../Pasted%20image%2020231225114608.png" /></p>
<p>有限域上的椭圆曲线:</p>
<p><img alt="Pasted image 20231225114041.png" src="../Pasted%20image%2020231225114041.png" /></p>
<h3 id="_13">计算<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<h4 id="_14">加法：几何上<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20231225114121.png" src="../Pasted%20image%2020231225114121.png" /></p>
<h4 id="_15">加法：代数上<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<p>和实数域上的公式是一样的，只不过需要 <span class="arithmatex">\(\mod p\)</span>
try https://andrea.corbellini.name/ecc/interactive/modk-add.html</p>
<h3 id="order">椭圆曲线的阶(order)<a class="headerlink" href="#order" title="Permanent link">&para;</a></h3>
<p>椭圆曲线的阶：点的数量</p>
<h3 id="_16">标量乘法和循环子群<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p>标量乘法和实数域一样：
<img alt="Pasted image 20231225113316.png" src="../Pasted%20image%2020231225113316.png" />
其中 n 为自然数。</p>
<p>有限域中椭圆曲线的点相乘（标量乘法）有一个有趣的特性。选取曲线 <span class="arithmatex">\(y^2≡x^3+2x+3\)</span>(mod 97) 和点 P=(3,6) 。现在计算 P 的所有倍数：</p>
<p><img alt="Pasted image 20231225115038.png" src="../Pasted%20image%2020231225115038.png" /></p>
<p><img alt="Pasted image 20231225115059.png" src="../Pasted%20image%2020231225115059.png" /></p>
<p>这构成了只包含 5 个元素的循环子群，P 叫做 generator 或者 base point。</p>
<p>循环子群是 ECC 和其他密码系统的基础。</p>
<p>循环子群的阶（order）n，是使得 nP = 0 的最小的正整数 n。</p>
<p>椭圆曲线算法就是在循环子群上工作的，相关的参数:</p>
<p><img alt="Pasted image 20231225115926.png" src="../Pasted%20image%2020231225115926.png" />
<strong>domain parameters</strong> 一共包含上面的 6 个 tuple <span class="arithmatex">\((p, a, b, G, n, h)\)</span></p>
<p>Code:
https://github.com/andreacorbellini/ecc/blob/master/scripts/ecdhe.py
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">EllipticCurve</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;EllipticCurve&#39;</span><span class="p">,</span> <span class="s1">&#39;name p a b g n h&#39;</span><span class="p">)</span>

<span class="n">curve</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span>
    <span class="s1">&#39;secp256k1&#39;</span><span class="p">,</span>
    <span class="c1"># Field characteristic.</span>
    <span class="n">p</span><span class="o">=</span><span class="mh">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f</span><span class="p">,</span>
    <span class="c1"># Curve coefficients.</span>
    <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">b</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="c1"># Base point.</span>
    <span class="n">g</span><span class="o">=</span><span class="p">(</span><span class="mh">0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798</span><span class="p">,</span>
       <span class="mh">0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8</span><span class="p">),</span>
    <span class="c1"># Subgroup order.</span>
    <span class="n">n</span><span class="o">=</span><span class="mh">0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141</span><span class="p">,</span>
    <span class="c1"># Subgroup cofactor.</span>
    <span class="n">h</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></p>
<h3 id="_17">如何寻找循环子群的阶<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p>P 的阶数通过拉格朗日定理与椭圆曲线的阶数联系起来，该定理指出子群的阶数是父群阶数的除数。换句话说，如果椭圆曲线包含 N 个点，并且其子群之一包含 n 点，则 n 是 N 的除数。</p>
<p>找到 n 的方法：</p>
<ol>
<li>使用 Schoof 算法计算椭圆曲线的阶数 N</li>
<li>找出 N 的所有除数</li>
<li>对于每个除数 n，计算 nP</li>
<li>使得 nP = 0 最小的 n 是子群的阶</li>
</ol>
<h3 id="generator">如何寻找 generator<a class="headerlink" href="#generator" title="Permanent link">&para;</a></h3>
<p>对于我们的 ECC 算法，我们需要高阶子组。所以一般我们会选择一条椭圆曲线，计算它的阶数（ N ），选择一个高除数作为子群阶数（ n ）并最终找到合适的基点。也就是说：我们不会选择一个基点，然后计算它的阶数，而是相反：我们会先选择一个看起来足够好的阶数，然后再寻找合适的基点。</p>
<p>拉格朗日定理意味着数字 <span class="arithmatex">\(h = N/n\)</span> 始终是整数（因为 n 是 N 的除数）。数字 h 有一个名称：它是子群的辅因子(<strong>cofactor of the subgroup</strong>)。</p>
<p>对于椭圆曲线上的每个点 P，都有 NP = 0</p>
<p>则：n(hP) = 0</p>
<p>G = hP 就是我们要找的 generator（如果 G 不为 0）</p>
<p>寻找 generator方法：</p>
<ol>
<li>计算椭圆曲线的阶 N</li>
<li>选择子群的 order n。为了使算法正常工作，该数字必须是素数并且必须是 N 的除数。</li>
<li>计算  <span class="arithmatex">\(h = N/n\)</span> </li>
<li>在曲线上选择一个随机点 P</li>
<li>计算 G = hP </li>
<li>如果 G 为 0，返回步骤 4，如果 G 不为 0，则 G 就是 generator</li>
</ol>
<p>注意，此算法仅在 n 为素数时才有效，因为如果不是素数，就表明 n 有除数，就无法保证 n 是使得 nP = 0 的最小的正整数 n。拿上面 order 为 5 的循环子群作为例子，如果找到的 n = 10，也满足 10P = 0，但是 10 不是真正的阶，而 5 才是。这里 10 不是素数，5 是素数。</p>
<h2 id="_18">参考<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h2>
<ul>
<li>https://andrea.corbellini.name/2015/05/17/elliptic-curve-cryptography-a-gentle-introduction/</li>
<li>《椭圆曲线 (颜松远) 》</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
      
    
  </body>
</html>